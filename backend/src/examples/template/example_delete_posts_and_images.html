<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <title>投稿と画像の一括削除デモ</title>
    <style>
        body { font-family: sans-serif; margin: 2em; line-height: 1.6; background-color: #f5f6fa; }
        .container { max-width: 720px; margin: 0 auto; }
        h1 { margin-bottom: 1rem; }
        textarea { width: 100%; min-height: 120px; padding: 0.8rem; font-family: monospace; }
        button { padding: 0.7rem 1.6rem; border-radius: 4px; border: none; cursor: pointer; background-color: #0069d9; color: #fff; font-size: 1rem; }
        .section { background-color: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); margin-bottom: 1.5rem; }
        .messages { margin-top: 1.5rem; }
        .message { border-left: 4px solid; padding: 1rem; margin-bottom: 0.8rem; background-color: #fdfdfd; }
        .message.success { border-color: #28a745; background-color: #eaf8ee; }
        .message.error { border-color: #dc3545; background-color: #fde7eb; }
        .message.warning { border-color: #ffc107; background-color: #fff6db; }
        .message strong { display: inline-block; margin-right: 0.4rem; }
        .hint { color: #555; font-size: 0.92rem; }
        ul.sample { background: #f1f3f5; padding: 0.8rem 1rem; border-radius: 6px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>投稿と関連画像の一括削除</h1>

        <div class="section">
            <p class="hint">post_id のリストを入力して送信すると、Cloud SQL 上の投稿と関連画像 (GCS) を順に削除します。<br>
                JSON 配列 (<code>["uuid1", "uuid2"]</code>) またはカンマ / 改行区切りで入力してください。</p>
            <ul class="sample">
                <li><code>["11111111-1111-1111-1111-111111111111", "22222222-2222-2222-2222-222222222222"]</code></li>
                <li><code>11111111-1111-1111-1111-111111111111, 22222222-2222-2222-2222-222222222222</code></li>
                <li>改行区切りも可</li>
            </ul>
            <form method="post">
                <label for="post_ids_input">post_id リスト</label>
                <textarea id="post_ids_input" name="post_ids_input" placeholder='["uuid1", "uuid2"]'>{{ raw_input }}</textarea>
                <div style="margin-top: 1rem;">
                    <button type="submit">削除を実行</button>
                </div>
            </form>
        </div>

        {% if results %}
        <div class="section messages">
            <h2>結果</h2>
            {% for level, text in results %}
            <div class="message {{ level }}">
                <p>{{ text }}</p>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</body>
</html>
